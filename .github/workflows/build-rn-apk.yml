name: Simple Android Build

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Generate package files
      run: |
        # Create minimal package.json
        cat > package.json << 'EOF'
        {
          "name": "shaqohub",
          "version": "1.0.0",
          "main": "node_modules/expo/AppEntry.js",
          "scripts": {
            "start": "expo start",
            "android": "expo start --android",
            "ios": "expo start --ios",
            "web": "expo start --web"
          },
          "dependencies": {
            "expo": "^50.0.0",
            "expo-linear-gradient": "^12.5.0",
            "react": "18.2.0",
            "react-native": "0.73.0"
          },
          "private": true
        }
        EOF
        
        # Create package-lock.json
        npm install
        
    - name: Check App.js
      run: |
        if [ ! -f "App.js" ]; then
          echo "Error: App.js not found in repository!"
          echo "Please make sure you have App.js in your project root."
          exit 1
        fi
        echo "App.js found, continuing..."
        
    - name: Create app.json
      run: |
        cat > app.json << 'EOF'
        {
          "expo": {
            "name": "ShaqoHub",
            "slug": "shaqohub",
            "version": "1.0.0",
            "platforms": ["android"],
            "android": {
              "package": "com.shaqohub.app"
            }
          }
        }
        EOF
        
    - name: Install Expo CLI
      run: npm install -g expo-cli
      
    - name: Show build instructions
      run: |
        echo "=============================================="
        echo "BUILD SETUP COMPLETE"
        echo "=============================================="
        echo ""
        echo "To build the APK, you need to:"
        echo ""
        echo "OPTION 1: Build with Expo (requires token)"
        echo "1. Get EXPO_TOKEN from: https://expo.dev/settings/access-tokens"
        echo "2. Add it to GitHub Secrets"
        echo "3. Update workflow to use: expo build:android"
        echo ""
        echo "OPTION 2: Build locally on your machine:"
        echo "1. Install dependencies: npm install"
        echo "2. Install Expo CLI: npm install -g expo-cli"
        echo "3. Login: expo login"
        echo "4. Build: expo build:android"
        echo ""
        echo "OPTION 3: Use EAS Build (recommended):"
        echo "1. Install: npm install -g eas-cli"
        echo "2. Login: eas login"
        echo "3. Configure: eas build:configure"
        echo "4. Build: eas build --platform android"
        echo "=============================================="
